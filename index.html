<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wheat Plant Detection</title>

  <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css"/>
  <script type="module" src="https://pyscript.net/releases/2025.11.2/core.js"></script>

  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Wheat Plant Detection</h1>
    <p>Use this AI to classify your wheat plant into one of 3 categories.</p>
  </header>

  <div class="upload-section">
    <div class="button-row">
      <label for="imageInput" class="upload-label">ðŸ“· Choose Image</label>
      <button id="classifyBtn" class="upload-btn">Classify</button>
    </div>

    <input type="file" id="imageInput" accept="image/*" style="display:none;">

    <div id="preview-container">
      <img id="preview" style="display:none; max-width:300px; max-height:300px;">
    </div>
  </div>

  <div id="result" class="result-badge"></div>

  <py-script>
<py-script output="none">
import asyncio
import random
from pyscript import when

CATEGORIES = ["Healthy", "Disease A", "Disease B"]
selected_file = None

def fake_classifier(image_bytes):
    return random.choice(CATEGORIES)

# Preview handler
@when("change", "#imageInput")
async def preview_image(event):
    global selected_file
    selected_file = event.target.files[0]
    if not selected_file:
        return
    data_url = await selected_file.toDataURL()
    preview = document.getElementById("preview")
    preview.src = data_url
    preview.style.display = "block"

# Classify handler
@when("click", "#classifyBtn")
async def classify_image(event):
    if not selected_file:
        document.getElementById("result").innerText = "No image selected!"
        return
    array_buffer = await selected_file.arrayBuffer()
    image_bytes = bytes(array_buffer.to_bytes())
    category = fake_classifier(image_bytes)
    document.getElementById("result").innerText = f"Predicted: {category}"
</py-script>

  </py-script>
</body>
</html>
